"hello"
install.packages("car","gplots","HH","rrcov","multicomp","effects","MASS","mvoutlier")
11715.25+3841.12-1372.55
## Q1 and Q2: Read data set and delete missing values
CrimeData<- read.csv(url("http://archive.ics.uci.edu/ml/machine-learning-databases/communities/communities.data"), header=FALSE)
setwd("~/Desktop/stat385/")
install.packages("MASS")
DataInfo<-read.table(file="crime-data-info.txt",header=FALSE)
SampleInfo<-c("State","County","CommCode","CommName","fold")
colnameinfo<-c(SampleInfo,as.character(DataInfo[,1]))
Missingcols<-which(DataInfo[,9]>0)+5
CompleteCrimeData<-CrimeData[,-c(1,2,3,5,Missingcols)]
colnames(CompleteCrimeData)<-colnameinfo[-c(1,2,3,5,Missingcols)]
CompleteCrimeData$ViolentCrimesPerPop<-CompleteCrimeData$ViolentCrimesPerPop-mean(CompleteCrimeData$ViolentCrimesPerPop)
## Q3:  Set the training and test data set
trainset0<-CompleteCrimeData[1:1800,-1]
testset0<-CompleteCrimeData[1801:1994,]
lm1<-lm(ViolentCrimesPerPop ~.-1, data=trainset0)
summary(lm1)
prediction <- predict(lm1, testset0[,-c(1,101)])
errors <- prediction - testset0[,101]
errors
sqrt(sum(errors^2))
library(MASS)
AICmod<-stepAIC(lm1,direction="both",trace=1)
backwardModel <- stepAIC(lm1, direction = "backward", trace = FALSE)
summary(backwardModel)
# Forward selection (Starting with a minimal model)
forwardModel <- stepAIC(lm1, scope = list(lower = ~1, upper = lm1$formula), direction = "forward", trace = FALSE)
summary(forwardModel)
# Predict and calculate RMSE for forward model
predictionsForward <- predict(forwardModel, newdata = testset[,-100])
# Predict and calculate RMSE for forward model
predictionsForward <- predict(forwardModel, newdata = testset0[,-100])
errorsForward <- testset0[,100] - predictionsForward
# Predict and calculate RMSE for forward model
predictionsForward <- predict(forwardModel, newdata = testset0[,-100])
AICmod<-stepAIC(lm1,direction="both",trace=FALSE)
summary(AICmod)
subsetindex<-colnames(testset0)%in%names(AICmod$coefficients)
newdata<-data.frame(as.matrix(testset0[,subsetindex]))
AICpredbias<-predict(AICmod,newdata=newdata)-testset0[,101]
AICmodsse<-norm(AICpredbias,type="2")
AICmodsse
getwd()
